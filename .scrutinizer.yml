build:
  nodes:
    analysis:
      dependencies:
        before:
          - composer require codeception/codeception:^4.1
          - composer require codeception/module-webdriver --dev
      environment:
        php:
          version: 7.4
          pecl_extensions:
            - zip
      tests:
        override:
          - php-scrutinizer-run
    coverage:
      environment:
        php:
          version: 7.4
        hosts:
          dev.local: '127.0.0.1'
        apache2:
          modules: ['rewrite']
          sites:
            ubiquity:
              host: 'dev.local'
              web_root: 'tests/www/'
        selenium: true
        google_chrome:
          use_latest: true
      services:
      tests:
        before:
          - sudo cp tests/files/xdebug.ini /home/scrutinizer/.phpenv/versions/7.4.3/etc/conf.d/xdebug.ini
          - (cd tests/www/ && composer require phpmv/php-reactjs:dev-master)
          - sudo curl -v http://dev.local/index.php

        override:
          - command: (./vendor/bin/codecept build && ./vendor/bin/codecept run --coverage-xml -v)
            coverage:
              file: tests/_output/coverage.xml
              format: clover

filter:
    paths: ["src/PHPMV/*"]
    excluded_paths:

checks:
    php:
        code_rating: true
        duplication: true
